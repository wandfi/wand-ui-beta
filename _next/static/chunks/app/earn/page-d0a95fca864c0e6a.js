(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{38946:function(e,s,t){"use strict";t.d(s,{Z:function(){return o}});var a=t(55731),l=t(64103),n=t(86960),r=t(52100),i=t(13012),d=t(40460);let c=(0,i.fn)("Divider"),o=l.forwardRef((e,s)=>{let{className:t}=e,i=(0,a.__rest)(e,["className"]);return l.createElement("div",Object.assign({ref:s,className:(0,d.q)(c("root"),"w-full mx-auto","bg-tremor-background-subtle","dark:bg-dark-tremor-background-subtle",n.N.threeXs.height,r.W.threeXl.marginTop,r.W.threeXl.marginBottom,t)},i))});o.displayName="Divider"},27777:function(e,s,t){Promise.resolve().then(t.bind(t,97052))},97052:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return EarnPage}});var a=t(31113),l=t(26504),n=t(19757),r=t(22139),i=t(59175),d=t(45438),c=t(64103);let o={};var m=t(15506),u=t(78354),x=t(26361),h=t(75930),k=t(84944),b=t(38946),p=t(62653),v=t(33501),f=t(41690),g=t.n(f),j=t(53060),T=t(72366),y=t(99548),N=t(35664),w=t(91214),A=t(33621),S=t(36762),_=t(6371),R=t(2794),E=t(22719),P=t(15948);function WrapDiv(e){let{children:s,wrap:t,...l}=e;return t?(0,a.jsx)("div",{...l,children:s}):s}function FmtPercent(e){let{className:s,value:t,decimals:l,showDecimals:n=2,plusI0:r=!0}=e,i=0n==t?0n:t||0n,d=r?i>=0n:i>0n,c=null==t||void 0==t||"bigint"!=typeof t;return(0,a.jsx)("span",{className:(0,x.cn)(s,d?"text-green-600":"text-red-600"),children:c?"-%":(0,a.jsxs)(a.Fragment,{children:[d&&"+",(0,x.Jh)(i,l,n)]})})}var D=t(73216);function TokenValue(e){let{symbol:s,value:t,decimals:l}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(g(),{className:"inline-block",alt:"usb",width:16,height:16,src:"/".concat(s,".svg")}),(0,k.dq)(t,l)]})}function DualTokenCard(e){let{type:s,vc:t}=e,f="buy"==s,g=(0,i.p)(),M=f?n.O1[g]:t.assetTokenAddress,q=f?t.assetTokenAddress:t.xTokenAddress,C=f?"USB":t.assetTokenSymbol,B=f?t.assetTokenSymbol:"USB",z=f?"Buy ".concat(t.assetTokenSymbol," Low"):"Sell ".concat(t.assetTokenSymbol," High"),H=f?t.ptyPoolBelowAddress:t.ptyPoolAboveAddress,{prices:F,balances:U,earns:I,vaultsState:V,assetLocked:Z,vaultUSBTotal:J,usbApr:W}=(0,c.useContext)(h.g),Y=V[t.vault],L=I[H],{address:O}=(0,T.m)(),G=U[M],[X,$]=(0,c.useState)(""),K=(0,x.su)(X),Q=f?t.xTokenSymbol:t.assetTokenSymbol,ee=f?t.assetTokenSymbol:t.xTokenSymbol;(0,c.useMemo)(()=>L.totalStake*(0,x.ok)(F,M,r.Pq)/r.Pq,[F[M],L.totalStake]);let es=f?null==Y?void 0:Y.AARS:null==Y?void 0:Y.AARU,et=(0,x.ok)(Z,t.assetTokenAddress),ea=(0,x.ok)(J,t.vault),el=(0,c.useMemo)(()=>es&&Y.AARDecimals&&0n!=et&&0n!=ea?es*ea*r.Pq/Y.AARDecimals/et/BigInt(1e9):(0,x.ok)(F,t.assetTokenAddress),[es,ea,Y.AARDecimals,et]),en=f?"Stake $USB, and when the ".concat(t.assetTokenSymbol," price falls to the target, it will trigger the purchase of ").concat(t.assetTokenSymbol," with staked $USB."):"Stake ".concat(t.assetTokenSymbol,", and when the ").concat(t.assetTokenSymbol," price rises to the target, staked ").concat(t.assetTokenSymbol," will be sold."),er=(0,m.D2)({abi:l.aT,address:H,functionName:"getAccruedMatchingYields"}),ei=(0,x.ok)(er,"data"),ed=(0,c.useMemo)(()=>{let e=(0,x.ok)(L,"totalStake");if(0n==e||0n==F[M])return"0.00%";let s=10n**(Y.AARDecimals||10n),t=(Y.AART-s)*el;if(0n==t)return"0.00%";let a=f?(Y.AART*Y.M_USB_ETH*r.Pq-Y.M_ETH*el*s)/(Y.AART-s)/r.Pq:(Y.M_ETH*el*s-Y.AART*Y.M_USB_ETH*r.Pq)/t;return e=(0,x.NA)([e,a]),(0,x.Jh)(ei*F[q]*r.Pq/(e*F[M]),18,3)},[L.totalStake,ei,q,M,F[q],F[M],f]),ec=(0,d.i)(),eo=(0,x.ok)(ec[H],"staking"),em=F[t.assetTokenAddress]>0&&el>0n?f?(F[t.assetTokenAddress]-el)*10n**10n/F[t.assetTokenAddress]:(el-F[t.assetTokenAddress])*10n**10n/F[t.assetTokenAddress]:0n,eu=(0,c.useMemo)(()=>{let e=10n**(Y.AARDecimals||10n),s=(Y.AART-e)*el/e;if(0n==s)return 0n;if(f){let t=(Y.AART*Y.M_USB_ETH*r.Pq-Y.M_ETH*el*e)/e/s,a=t*el/r.Pq,l=L.stake,n=L.totalStake>a&&a>=0n?l*a/L.totalStake:l;return n}{let t=(Y.M_ETH*el*e-Y.AART*Y.M_USB_ETH*r.Pq)/e/s,a=L.stake,l=L.totalStake>t&&t>=0n?a*t/L.totalStake:a;return l}},[L,Y,f,el]),ex=(0,c.useMemo)(()=>{let e=f?[{key:"eth_price",label:"ETH Price",value:(0,k.dq)(F[t.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,a.jsxs)("div",{children:[(0,k.dq)(el)," (",(0,a.jsx)(FmtPercent,{value:em<0n?void 0:-em,decimals:10,plusI0:!1}),")"]}),groupEnd:!0},{key:"apr_interest",label:"APY",value:(0,x.Jh)(W.apr+eo,W.aprDecimals,2),detail:(0,a.jsxs)("div",{className:"pl-2",children:[(0,a.jsxs)("div",{children:["~USB Interest: ",(0,x.Jh)(W.apr,W.aprDecimals,2)]}),(0,a.jsxs)("div",{children:["~",Q," Yield: ",(0,x.Jh)(eo,W.aprDecimals,2)]})]}),groupEnd:!0},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a purchase action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:ee,value:ei})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(ed," (Est.)")}]:[{key:"eth_price",label:"ETH Price",value:(0,k.dq)(F[t.assetTokenAddress])},{key:"target_price",label:"Target Price",value:(0,a.jsxs)("div",{children:[(0,k.dq)(el)," (",(0,a.jsx)(FmtPercent,{value:em<0n?void 0:em,decimals:10,plusI0:!0}),")"]}),groupEnd:!0},{key:"apr_yield",label:"APY(".concat(Q," Yield)"),value:(0,x.Jh)(eo,W.aprDecimals,2),groupEnd:!0},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a sell action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:ee,value:ei})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(ed," (Est.)")}];return e},[L,ei]),eh=(0,c.useMemo)(()=>{let e=f?[{key:"successfully_brought",label:"Successfully Bought",value:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(TokenValue,{symbol:B,value:L.match}),(0,a.jsx)("span",{children:"+"}),(0,a.jsx)(TokenValue,{symbol:ee,value:L.earnForMatch}),(0,a.jsx)(_.C,{inFlex:!0,children:"From Reward Pool"})]})},{key:"staking_earend",label:"".concat(Q," Earned"),value:(0,a.jsx)(TokenValue,{symbol:Q,value:L.earn})}]:[{key:"successfully_sold",label:"Successfully Sold",value:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(TokenValue,{symbol:B,value:L.match}),(0,a.jsx)("span",{children:"+"}),(0,a.jsx)(TokenValue,{symbol:ee,value:L.earnForMatch}),(0,a.jsx)(_.C,{inFlex:!0,children:"From Reward Pool"})]})}];return e},[L,B,Q,ee]),{write:ek,isDisabled:eb,isLoading:ep}=(0,u.R)({abi:l.aT,address:H,functionName:"claimAll"}),ev=function(e){let s=(0,c.useRef)(null);return o[e]&&o[e].includes(s)||(o[e]=[...o[e]||[],s]),(0,c.useEffect)(()=>{if(!s.current)return()=>{};let onResize=()=>{let t=o[e]||[],a=t.reduce((e,s)=>{var t;return Math.max((null===(t=s.current)||void 0===t?void 0:t.clientHeight)||0,e)},0);t.filter(e=>e!=s).forEach(e=>{var s;let t=(null===(s=e.current)||void 0===s?void 0:s.clientHeight)||0;t!==a&&a>0&&e.current&&(e.current.style.height="".concat(a,"px"))})};return window.addEventListener("resize",onResize),onResize(),()=>{window.removeEventListener("resize",onResize)}},[s.current]),s}(t.vault),ef=(0,R.IS)();ef.find(e=>e.symbol==C);let[eg,ej]=(0,P.n)(e=>{let{width:s}=e;return s<512});return(0,a.jsxs)("div",{className:"card flex flex-col",ref:eg,children:[(0,a.jsxs)("div",{className:"flex gap-5 items-center justify-between",ref:ev,children:[(0,a.jsxs)("div",{className:"flex gap-3 md:gap-5 items-center",children:[(0,a.jsxs)("div",{className:"relative w-fit shrink-0",children:[(0,a.jsx)(A.c,{size:32,symbol:C,className:"md:hidden"}),(0,a.jsx)(A.c,{size:40,symbol:C,className:"hidden md:block"}),(0,a.jsx)(A.c,{size:16,symbol:B,className:"absolute -right-1 -bottom-1 md:hidden"}),(0,a.jsx)(A.c,{size:24,symbol:B,className:"absolute -right-2 -bottom-2 hidden md:block"})]}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h6",{className:"page-sub",children:z||"title"}),(0,a.jsx)(_.C,{children:en})]})})]}),(0,a.jsxs)(WrapDiv,{wrap:ej,className:"flex flex-col-reverse gap-1 items-end",children:[(0,a.jsx)(E._,{icons:["blast","gold","wand"]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs text-black dark:text-slate-50 font-medium text-right",children:["Total ",C," Staked"]}),(0,a.jsx)("div",{className:"text-base text-black dark:text-slate-50 text-end font-semibold",children:(0,k.dq)(L.totalStake)})]})]})]}),(0,a.jsx)(b.Z,{className:"my-4 h-[1px] dark:bg-zinc-600 "}),(0,a.jsxs)(p.Z,{numItemsSm:2,className:"gap-x-2 flex-1",children:[(0,a.jsx)(p.Z,{numItemsSm:1,className:"gap-y-2 gap-x-7 md:border-r-[1px] border-[#E4E4E7] dark:border-zinc-600 mb-3 md:mb-0 ",children:null==ex?void 0:ex.map(e=>(0,a.jsxs)("div",{className:(0,v.Z)("flex flex-col text-sm",{"mb-4":e.groupEnd}),children:[(0,a.jsxs)("div",{className:"flex items-center flex-wrap",children:[(0,a.jsxs)("div",{className:"text-black dark:text-slate-50 font-medium mr-[5px]",children:[e.label," : ",e.tip&&(0,a.jsx)(_.C,{children:e.tip})]}),(0,a.jsx)("div",{className:"text-neutral-900 dark:text-slate-50 ml-2",children:e.value})]}),e.detail]},e.key))}),O&&(0,a.jsxs)(p.Z,{numItemsSm:1,className:"gap-x-1",children:[(0,a.jsx)("div",{className:"w-full border-t-[1px] border-[#E4E4E7] dark:border-zinc-600 md:border-0 md:px-[0px]",children:null==eh?void 0:eh.map(e=>(0,a.jsxs)("div",{className:"flex items-center flex-wrap mt-[8px] md:mt-0 md:mb-2",children:[(0,a.jsxs)("div",{className:"text-xs text-black dark:text-slate-50 whitespace-nowrap font-medium mr-[5px]",children:[e.label," :"]}),(0,a.jsx)("div",{className:"text-neutral-900 dark:text-slate-50 text-sm shrink-0 ml-2",children:e.value})]},e.key))}),(0,a.jsxs)("div",{className:"mt-auto h-fit",children:[(0,a.jsx)("div",{className:"w-full flex justify-center items-center",children:(0,a.jsxs)("button",{className:"btn-primary px-4 h-7 flex items-center w-[60%] md:w-fit self-end justify-center gap-4 bg-[#64738B]",disabled:eb||ep,onClick:()=>ek(),children:[ep&&(0,a.jsx)(S.$,{}),"Claim All"]})}),(0,a.jsxs)("div",{className:"relative flex flex-col gap-1 mt-4 md:mt-[28px] justify-center items-center text-[#64748B] text-sm font-medium p-3 rounded-md bg-slate-100 dark:bg-s1 dark:text-slate-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Staked",(0,a.jsx)(A.c,{symbol:C,size:16}),(0,k.dq)(L.stake),(0,a.jsx)("span",{className:"text-indigo-500 dark:text-violet-300 ml-[5px] cursor-pointer",onClick:()=>$((0,j.d)(L.stake)),children:"Max"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 pl-8",children:["-",(0,k.dq)(eu),(0,a.jsxs)(_.C,{inFlex:!0,children:["This is the amount of staked ",C," that will be ",f?"spent":"sold"," when price triggers."]})]})]})]})]})]}),O?(0,a.jsxs)("div",{className:"mt-4 md:mt-[30px]",children:[(0,a.jsx)(w.W,{amount:X,setAmount:$,asset:C,balance:G,checkBalance:!1}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(y.v,{tx:"Stake",disabled:K<=0n||K>G,onTxSuccess:()=>{$("")},config:{abi:l.aT,address:H,functionName:"stake",args:[K],value:C==(0,D.b)()?K:0n},className:"mt-2 w-[45%]",approves:{[M]:K},spender:H}),(0,a.jsx)(y.v,{className:"mt-2 w-[45%]",tx:"Withdraw",disabled:K<=0n||K>L.stake,onTxSuccess:()=>{$("")},config:{abi:l.aT,address:H,functionName:"withdraw",args:[K]}})]})]}):(0,a.jsx)("div",{className:"w-full flex items-center justify-center mt-[30px]",children:(0,a.jsx)(N.Z,{})})]})}function GroupDualTokenCard(e){let{vcs:s,type:t}=e,[l,n]=(0,c.useState)(s[s.length-1]);return 0==s.length?null:1==s.length?(0,a.jsx)(DualTokenCard,{vc:s[0],type:t}):(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(DualTokenCard,{vc:l,type:t}),(0,a.jsx)("div",{className:"absolute z-10 left-[86px] top-0 flex text-sm",children:s.map((e,s)=>(0,a.jsx)("div",{className:(0,v.Z)("cursor-pointer rounded-b-full border border-blue-500 px-1 py-1",{"bg-white text-black dark:text-slate-50":l!==e,"bg-blue-500 text-white":l===e}),onClick:()=>n(e),children:"V".concat(s+1)},"gdtc_"+s))})]})}var M=t(50553),q=t(62600);function EarnPage(){let e=(0,i.p)(),s=(0,c.useMemo)(()=>n.iK[e].filter(e=>!e.isStable),[e]);return(0,a.jsxs)("div",{className:"w-full h-full max-w-screen-xl px-4 mx-auto",children:[(0,a.jsx)(M.a,{}),(0,a.jsx)("h2",{className:"page-title",children:"Price Trigger Yield"}),(0,a.jsx)(q.r,{numItemsMd:2,className:"gap-3 mt-4",children:s.map((e,s)=>(0,a.jsxs)(c.Fragment,{children:[(0,a.jsx)(GroupDualTokenCard,{vcs:[e],type:"buy"}),(0,a.jsx)(GroupDualTokenCard,{vcs:[e],type:"sell"})]},"dual_card_group_".concat(s)))})]})}}},function(e){e.O(0,[7495,4643,7588,4176,5169,2659,4320,2639,8836,4044,7869,1690,8347,5631,5166,2653,9467,1578,7638,126,6534,7093,604,1744],function(){return e(e.s=27777)}),_N_E=e.O()}]);