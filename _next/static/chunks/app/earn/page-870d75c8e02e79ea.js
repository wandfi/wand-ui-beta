(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{35883:function(){},14034:function(e,t,s){"use strict";s.d(t,{Z:function(){return d}});var a=s(50044),l=s(2265),n=s(16737),r=s(37517),i=s(93568),c=s(76503);let o=(0,i.fn)("Divider"),d=l.forwardRef((e,t)=>{let{className:s}=e,i=(0,a.__rest)(e,["className"]);return l.createElement("div",Object.assign({ref:t,className:(0,c.q)(o("root"),"w-full mx-auto","bg-tremor-background-subtle","dark:bg-dark-tremor-background-subtle",n.N.threeXs.height,r.W.threeXl.marginTop,r.W.threeXl.marginBottom,s)},i))});d.displayName="Divider"},55139:function(e,t,s){"use strict";s.d(t,{r:function(){return a.Z}});var a=s(87456)},62166:function(e,t,s){Promise.resolve().then(s.bind(s,66790))},66790:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return EarnPage}});var a=s(57437),l=s(91056),n=s(72009),r=s(8580),i=s(2265);let c={};var o=s(12831),d=s(43003),u=s(81628),m=s(15898),x=s(20373),h=s(14034),f=s(87456),b=s(14181),p=s(16691),v=s.n(p),g=s(56926),k=s(76036),j=s(80547),y=s(72084),w=s(64020),N=s(30050),S=s(79352);function TokenValue(e){let{symbol:t,value:s,decimals:l}=e;return(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(v(),{className:"inline-block",alt:"usb",width:16,height:16,src:"/".concat(t,".svg")}),(0,x.dq)(s,l)]})}function DualTokenCard(e){let{type:t,vc:s}=e,p="buy"==t;p?n.O1[(0,l.BV)()]:s.assetTokenAddress;let T=p?"USB":s.assetTokenSymbol,A=p?s.assetTokenSymbol:"USB",R=p?"Buy ".concat(s.assetTokenSymbol," Low"):"Sell ".concat(s.assetTokenSymbol," High"),_=p?s.ptyPoolBelowAddress:s.ptyPoolAboveAddress,{prices:C,balances:E,earns:B,vaultsState:P,assetLocked:M,vaultUSBTotal:D}=(0,i.useContext)(m.g),q=P[s.vault],z=B[_],{address:W}=(0,g.mA)(),I=(0,i.useMemo)(()=>(0,u.ok)(null==E?void 0:E.find(e=>e.symbol===T),"balance"),[E,T]),[U,V]=(0,i.useState)(""),H=p?s.xTokenSymbol:s.assetTokenSymbol,F=p?s.assetTokenSymbol:s.xTokenSymbol,Z=(0,i.useMemo)(()=>z.totalStake*(0,u.ok)(C,T,r.Pq)/r.Pq,[C[T],z.totalStake]),L=p?null==q?void 0:q.AARS:null==q?void 0:q.AARU,O=(0,u.ok)(M,s.assetTokenSymbol),Y=(0,u.ok)(D,s.vault);(0,i.useMemo)(()=>L&&q.AARDecimals&&0n!=O&&0n!=Y?L*Y*r.Pq/q.AARDecimals/O/BigInt(1e9):(0,u.ok)(C,s.assetTokenFeed),[L,Y,q.AARDecimals,O]);let $=p?"Stake $USB, and when the ".concat(s.assetTokenSymbol," price falls to the target, it will trigger the purchase of ").concat(s.assetTokenSymbol," with staked $USB."):"Stake ".concat(s.assetTokenSymbol,", and when the ").concat(s.assetTokenSymbol," price rises to the target, staked ").concat(s.assetTokenSymbol," will be sold."),X=(0,i.useMemo)(()=>({abi:N.aT,address:_,functionName:"getAccruedMatchingYields",watch:!0}),[_]),K=(0,o.D2)(X),J=(0,u.ok)(K,"data"),G=(0,i.useMemo)(()=>{let e=(0,u.ok)(z,"totalStake");return 0n==e?"0.00%":(0,u.Jh)(J*r.Pq/e,18,2)},[z.totalStake,J]),Q=(0,i.useMemo)(()=>"2.00%",[C[H],Z]),ee=(0,i.useMemo)(()=>{let e=p?[{key:"eth_price",label:"ETH Price",value:(0,x.dq)(z.stake)},{key:"target_price",label:"Target Price",value:(0,x.dq)(z.match)},{key:"apr_yield",label:"APR(".concat(H," Yield)"),value:Q},{key:"apr_interest",label:"APR(".concat(H," Interest)"),value:Q},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a purchase action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:F,value:J,decimals:6})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(G," (Est.)")},{key:"usb_rebasable_apr",label:"USB Interest-bearing APR",value:(0,u.Rr)((0,u.ok)(q,"Y"),(0,u.ok)(q,"settingsDecimals"))}]:[{key:"eth_price",label:"ETH Price",value:(0,x.dq)(z.stake)},{key:"target_price",label:"Target Price",value:(0,x.dq)(z.match)},{key:"apr_yield",label:"APR(".concat(H," Yield)"),value:Q},{key:"transacation_reward_pool",label:"Reward Pool",tip:"The reward funds originates from protocol, and when a purchase action is triggered, these funds will be distributed proportionally.",value:(0,a.jsx)(TokenValue,{symbol:F,value:J,decimals:6})},{key:"discount_rate",label:"Reward Rate",tip:"This is an estimated value, to be determined upon triggering. Reward Rate =Reward/Transaction volume",value:"".concat(G," (Est.)")},{key:"usb_rebasable_apr",label:"USB Interest-bearing APR",value:(0,u.Rr)((0,u.ok)(q,"Y"),(0,u.ok)(q,"settingsDecimals"))}];return e},[z,J]),et=(0,i.useMemo)(()=>{let e=p?[{key:"successfully_brought",label:"Successfully Brought",value:(0,a.jsx)(TokenValue,{symbol:T,value:z.stake})},{key:"x_earend",label:"".concat(H," earned"),value:(0,a.jsx)(TokenValue,{symbol:A,value:z.match})}]:[{key:"successfully_sold",label:"Successfully Sold",value:(0,a.jsx)(TokenValue,{symbol:T,value:z.stake})},{key:"x_earend",label:"".concat(H," earned"),value:(0,a.jsx)(TokenValue,{symbol:A,value:z.match})}];return e},[z,J]),{write:es,isDisabled:ea,isLoading:el}=(0,d.R)({abi:N.aT,address:_,functionName:"claimAll"}),en=function(e){let t=(0,i.useRef)(null);return c[e]&&c[e].includes(t)||(c[e]=[...c[e]||[],t]),(0,i.useEffect)(()=>{if(!t.current)return()=>{};let onResize=()=>{let s=c[e]||[],a=s.reduce((e,t)=>{var s;return Math.max((null===(s=t.current)||void 0===s?void 0:s.clientHeight)||0,e)},0);s.filter(e=>e!=t).forEach(e=>{var t;let s=(null===(t=e.current)||void 0===t?void 0:t.clientHeight)||0;s!==a&&a>0&&e.current&&(e.current.style.height="".concat(a,"px"))})};return window.addEventListener("resize",onResize),onResize(),()=>{window.removeEventListener("resize",onResize)}},[t.current]),t}(s.vault);return(0,a.jsxs)("div",{className:"card flex flex-col",children:[(0,a.jsxs)("div",{className:"flex gap-5 items-center justify-between",ref:en,children:[(0,a.jsxs)("div",{className:"flex gap-5 items-center",children:[(0,a.jsxs)("div",{className:"relative w-fit shrink-0 h-[40px] w-[40px]",children:[(0,a.jsx)(v(),{width:40,height:40,src:"/".concat(T,".svg"),alt:""}),(0,a.jsx)(v(),{className:"absolute -right-2 -bottom-2",width:24,height:24,src:"/".concat(A,".svg"),alt:""})]}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h6",{className:"text-base leading-6 font-bold",children:R||"title"}),(0,a.jsx)(w.C,{children:$})]})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-xs text-black font-medium text-right",children:["Total ",T," Staked"]}),(0,a.jsx)("div",{className:"text-[24px] text-black font-semibold",children:(0,x.dq)(z.totalStake)})]})]}),(0,a.jsx)(h.Z,{className:"my-4"}),(0,a.jsxs)(f.Z,{numItemsSm:2,className:"gap-x-2 min-h-[188px]",children:[(0,a.jsx)(f.Z,{numItemsSm:1,className:"gap-y-2 gap-x-7 md:border-r-[1px] border-[#E4E4E7] mb-[12px] md-0",children:null==ee?void 0:ee.map(e=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"text-xs text-black font-medium mr-[5px]",children:[e.label," : ",e.tip&&(0,a.jsx)(w.C,{children:e.tip})]}),(0,a.jsx)("div",{className:"text-neutral-900 text-sm",children:e.value})]},e.key))}),W&&(0,a.jsxs)(f.Z,{numItemsSm:1,className:"gap-x-1",children:[(0,a.jsx)("div",{className:"w-full border-t-[1px] border-[#E4E4E7] md:border-0 md:px-[20px]",children:null==et?void 0:et.map(e=>(0,a.jsxs)("div",{className:"flex items-center mt-[8px] md:mt-0 md:mb-2",children:[(0,a.jsxs)("div",{className:"text-xs text-black font-medium mr-[5px]",children:[e.label," :"]}),(0,a.jsx)("div",{className:"text-neutral-900 text-sm",children:e.value})]},e.key))}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"w-full flex justify-center items-center",children:(0,a.jsxs)("button",{className:"btn-primary px-4 h-7 flex items-center w-[60%] md:w-fit self-end justify-center gap-4 bg-[#64738B]",disabled:ea||el,onClick:()=>es(),children:[el&&(0,a.jsx)(y.$,{}),"Claim All"]})}),(0,a.jsxs)("div",{className:"flex mt-[28px] justify-center items-center text-[#64748B] text-base font-medium",children:["Staked: ",(0,x.dq)(z.stake)," ",(0,a.jsx)("span",{className:"text-[#6466F1] ml-[5px]",onClick:()=>V((0,S.d)(z.stake)),children:"Max"})]})]})]})]}),(0,a.jsx)("div",{className:"flex-1"}),(0,a.jsx)("div",{className:"flex justify-between",children:(0,a.jsx)("div",{className:"text-sm text-slate-500 flex flex-col gap-3"})}),W?(0,a.jsxs)("div",{className:"mt-[30px]",children:[(0,a.jsx)(j.W,{amount:U,setAmount:V,asset:T,balance:I}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(k.v,{tx:"Stake",disabled:(0,u.su)(U)>I,onTxSuccess:()=>{V("")},config:{abi:N.aT,address:_,functionName:"stake",args:[(0,u.su)(U)],value:"ETH"==T?(0,u.su)(U):0n},className:"mt-2 w-[45%]",spender:_}),(0,a.jsx)(k.v,{className:"mt-2 w-[45%]",tx:"UnStake",disabled:(0,u.su)(U)>z.stake,onTxSuccess:()=>{V("")},config:{abi:N.aT,address:_,functionName:"withdraw",args:[(0,u.su)(U)]}})]})]}):(0,a.jsx)("div",{className:"w-full flex items-center justify-center mt-[30px]",children:(0,a.jsx)(b.x3,{})})]})}var T=s(55139);function EarnPage(){let e=n.iK[(0,l.BV)()].find(e=>"ETH"==e.assetTokenSymbol);return e?(0,a.jsxs)("div",{className:"w-full h-full max-w-screen-xl px-4 mx-auto",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Price Trigger Yield"}),(0,a.jsxs)(T.r,{numItemsSm:2,className:"gap-3 mt-4",children:[(0,a.jsx)(DualTokenCard,{vc:e,type:"buy"}),(0,a.jsx)(DualTokenCard,{vc:e,type:"sell"})]})]}):null}},76036:function(e,t,s){"use strict";s.d(t,{v:function(){return ApproveAndTx}});var a=s(57437),l=s(72009),n=s(81628),r=s(2265),i=s(71424),c=s(56926),o=s(72);let d={},useApproves=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10000000000n*BigInt(1e18),{address:a}=(0,c.mA)(),u=(0,c.t_)(),{data:m}=(0,c.py)(),[x,h]=(0,r.useState)(!1),f=(0,r.useMemo)(()=>Object.keys(e).filter(e=>e!==l.K8),[e]),[b,p]=(0,r.useState)(t&&d[t]||{}),updateAllownce=(e,s)=>{t&&(d[t]={...d[t]||{},[e]:s},p(t=>({...t,[e]:s})))},{data:v}=(0,c.Ov)();(0,r.useEffect)(()=>{a&&t&&f.forEach(e=>{u.readContract({abi:o.em,address:e,functionName:"allowance",args:[a,t]}).then(t=>updateAllownce(e,t)).catch(console.error)})},[f,a,v]);let[g,k]=(0,r.useState)(!1),j=(0,r.useMemo)(()=>f.filter(t=>(0,n.ok)(e,t)>0n&&(0,n.ok)(e,t)>(0,n.ok)(b,t)),[e,f,b]),approve=async()=>{if(0!=j.length&&t)try{k(!0),h(!1);for(let a=0;a<j.length;a++){let l=j[a],n=!1===s?e[l]:s,r=await (null==m?void 0:m.writeContract({abi:o.em,address:l,functionName:"approve",args:[t,n]}));r&&await (null==u?void 0:u.waitForTransactionReceipt({hash:r})),updateAllownce(l,n)}i.A.success("Approve success"),k(!1),h(!0)}catch(e){throw i.A.error((0,n.az)(e)),k(!1),h(!1),e}};return{approve,loading:g,shouldApprove:j.length>0,isSuccess:x}};var u=s(43003),m=s(35769),x=s(72084);function ApproveAndTx(e){let{className:t,tx:s,approves:l,spender:n,requestAmount:i,config:c,toast:o=!0,disabled:d,onTxSuccess:h,onApproveSuccess:f}=e,{write:b,isDisabled:p,isLoading:v,isSuccess:g}=(0,u.R)(c,o),k=(0,r.useRef)();k.current=h,(0,r.useEffect)(()=>{k.current&&g&&k.current()},[g]);let j=d||p||v||!1===c.enabled,{approve:y,shouldApprove:w,loading:N,isSuccess:S}=useApproves(l||{},n,i),T=(0,r.useRef)();return(T.current=f,(0,r.useEffect)(()=>{T.current&&S&&T.current()},[S]),w)?(0,a.jsxs)("button",{className:(0,m.m)("btn-primary flex items-center justify-center gap-4",t),onClick:y,disabled:d||!y||N,children:[N&&(0,a.jsx)(x.$,{}),"Approve"]}):(0,a.jsxs)("button",{className:(0,m.m)("btn-primary flex items-center justify-center gap-4",t),onClick:()=>b(),disabled:j,children:[v&&(0,a.jsx)(x.$,{}),s]})}},80547:function(e,t,s){"use strict";s.d(t,{W:function(){return AssetInput}});var a=s(57437),l=s(81628),n=s(20373),r=s(57042),i=s(16691),c=s.n(i),o=s(2265),d=s(16775),u=s(82288);function AssetInput(e){let{asset:t="ETH",balance:s,balanceTit:i="Balance",balanceDecimals:m=18,exchange:x,readonly:h,selected:f,onClick:b,amount:p,setAmount:v,price:g,disable:k,hasInput:j=!1,options:y,onChange:w=()=>{},defaultValue:N,balanceClassName:S=""}=e,T=(0,o.useRef)(null),A=void 0!==s&&(0,l.su)("number"==typeof p?p+"":p||"")>("bigint"==typeof s?s:0n);return(0,a.jsxs)("div",{className:"relative w-full",onClick:()=>{b&&!k&&b()},children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"absolute flex items-center gap-2 top-1/2 left-4 -translate-y-1/2",children:[(0,a.jsx)(c(),{width:24,height:24,src:"/".concat(t,".svg"),alt:""}),(0,a.jsxs)("div",{className:"text-base font-medium",children:[(0,a.jsxs)("div",{children:[j?(0,a.jsx)(u.ZP,{options:y,onChange:w,defaultValue:N,styles:{control:(e,t)=>({...e,border:"0px",minHeight:"24px",padding:"0px",background:"rgb(248 250 252)"})}}):(0,a.jsx)("div",{children:t}),g&&(0,a.jsx)("div",{className:"text-neutral-500 text-xs",children:g})]}),x&&(0,a.jsxs)("div",{className:"text-slate-500 text-xs",children:["~$",x]})]})]}),(0,a.jsx)("input",{value:p,onChange:e=>v(e.target.value),ref:T,type:"number",disabled:k,className:(0,r.Z)(h?"bg-slate-50":"bg-white",{"border-red-400 !border-2 focus:border-red-400":A,"border-slate-400  focus:border-blue-400 ":!A},"w-full h-14 text-right pr-4 font-bold text-2xl border focus:border-2 text-slate-700 rounded-md outline-none"),placeholder:"0.000",step:.01,title:"",readOnly:h})]}),void 0!=s&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1 px-1 text-slate-400 text-sm",children:[(0,a.jsxs)("div",{className:S,children:[(0,a.jsxs)("span",{children:[i,": ",(0,n.Rp)(s,3,m)]}),(0,a.jsx)("button",{className:"text-indigo-500 ml-2",onClick:()=>{let e=(0,d.b)(s,m);v(e),b&&!k&&b()},children:"Max"})]}),(0,a.jsx)("div",{className:"text-sm text-red-400",children:A?"Insufficient account balance":""})]})]})}},72084:function(e,t,s){"use strict";s.d(t,{$:function(){return Spinner}});var a=s(57437);let Spinner=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{fill:"none",className:t?"text-white":"animate-spin h-5 w-5 2-ml-1 2mr-3",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}},64020:function(e,t,s){"use strict";s.d(t,{C:function(){return Tip}});var a=s(57437),l=s(75224),n=s(71824);function Tip(e){let{children:t,node:s}=e;return(0,a.jsx)(l.zt,{children:(0,a.jsxs)(l.fC,{children:[(0,a.jsx)(l.xz,{asChild:!0,children:s?(0,a.jsx)("div",{className:"inline-block",style:{verticalAlign:"text-bottom"},children:s}):(0,a.jsx)("div",{className:"inline-block px-1",style:{verticalAlign:"text-bottom"},children:(0,a.jsx)(n.if7,{className:"inline-block w-[14px] h-[14px] stroke-slate-500"})})}),(0,a.jsx)(l.h_,{children:(0,a.jsxs)(l.VY,{className:"max-w-xs text-sm text-white bg-slate-900 rounded-md p-4",children:[t,(0,a.jsx)(l.Eh,{})]})})]})})}},43003:function(e,t,s){"use strict";s.d(t,{R:function(){return useWrapContractWrite}});var a=s(81628),l=s(2265),n=s(71424),r=s(56926),i=s(12831);function useWrapContractWrite(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],[s,c]=(0,l.useState)(!1),[o,d]=(0,l.useState)(!1),u=(0,r.t_)(),{data:m}=(0,r.py)(),x=!u||!m||!m.account||s||!e||"object"==typeof e&&!1==e.enabled,write=async()=>{if(!x){c(!0),d(!1);try{let s="function"==typeof e?await e():await (0,i.zp)(e),a=await m.writeContract({account:m.account,address:s.address,abi:s.abi,functionName:s.functionName,args:s.args,value:s.value}),l=await u.waitForTransactionReceipt({hash:a});if("success"!==l.status)throw"Transaction reverted";d(!0),t&&n.A.success("Transaction success")}catch(e){t&&n.A.error((0,a.az)(e))}c(!1)}};return{write,isDisabled:x,isLoading:s,isSuccess:o}}},20373:function(e,t,s){"use strict";s.d(t,{Rp:function(){return displayBalanceWithUnit},ZM:function(){return displayBalanceWithoutFormat},dq:function(){return displayBalance}});var a=s(16775),l=s(79352);let displayBalanceWithUnit=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2?arguments[2]:void 0;if(!e)return"0.000";let l=10**t;return(Math.floor(Number((0,a.b)(e,s))*l)/l).toLocaleString("en-US",{maximumFractionDigits:t})},displayBalance=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!e)return"0.000";let s=10**t;return(Math.floor(Number((0,l.d)(e))*s)/s).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})},displayBalanceWithoutFormat=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!e)return"0.000";let s=10**t;return String(Math.floor(Number((0,l.d)(e))*s)/s)}}},function(e){e.O(0,[3027,8061,9593,9510,2539,510,8156,619,4725,7356,2128,4322,2971,2472,1744],function(){return e(e.s=62166)}),_N_E=e.O()}]);