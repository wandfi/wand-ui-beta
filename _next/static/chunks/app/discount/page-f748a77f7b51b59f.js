(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[143],{33490:function(e,s,t){Promise.resolve().then(t.bind(t,23159))},23159:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return DiscountPage}});var l=t(57437),a=t(76036),n=t(80547),i=t(1150),r=t(90228),o=t(91056),c=t(72009),d=t(8580),u=t(81628),x=t(99057),m=t(20373),h=t(16691),f=t.n(h),g=t(2265),v=t(41697),p=t(35769),b=t(21693),A=t(56926);function DiscountPage(){let{vaultsMode:e,vaultsState:s,balances:t,prices:h}=(0,g.useContext)(x.FetcherContext),j=c.iK[(0,o.BV)()].find(e=>"ETH"==e.assetTokenSymbol),w=s[j.assetTokenSymbol],N=e[j.assetTokenSymbol],k=(0,A.do)({abi:i.Z,address:j.vault,functionName:"getParamValue",args:[(0,b.$G)("CircuitBreakPeriod",{size:32})]}),T=(0,u.ok)(k,"data"),R=(0,u.ok)(w,"AARBelowCircuitBreakerLineTime"),S=N>=2&&T>0n&&w&&((0,u.ok)(w,"aar")>=(0,u.ok)(w,"AARC")||BigInt(new Date().getTime()/1e3)-R>=T),y=S?"Discount available":"No discount",B=!S,D=(0,u.ok)(h,j.xTokenSymbol),P=[{value:"ETHx",label:"ETHx"},{value:"USDB",label:"USDB"}],E=(0,g.useMemo)(()=>(0,u.ok)(null==t?void 0:t.find(e=>"USB"===e.symbol),"balance"),[t]),[L,U]=(0,g.useMemo)(()=>{if(!w)return["50%","50%"];let e=(0,u.pF)(w.AARU,w.AARDecimals),s=(0,u.pF)(w.aar,w.AARDecimals),t=(0,u.pF)(w.AARS,w.AARDecimals),l=(0,u.pF)(w.AART,w.AARDecimals),a=e/2,toPercent=s=>(100*Math.max(0,Math.min(1,(s-a)/(e-a)))).toFixed(2)+"%",n=toPercent(s);return B?[n,toPercent(t)]:[n,toPercent(l)]},[null==w?void 0:w.AARU,null==w?void 0:w.aar,null==w?void 0:w.AARS,null==w?void 0:w.AART,B]),[V,C]=(0,g.useState)(""),[q,M]=(0,g.useState)("ETHx"),{data:Z}=(0,A.do)({watch:!0,abi:r.Z,address:c.jX[(0,o.BV)()],functionName:"calcUsbToLeveragedTokens",args:[j.vault,(0,u.su)(V)]}),{data:F}=(0,A.do)({watch:!0,abi:r.Z,address:c.jX[(0,o.BV)()],functionName:"calcUsbToLeveragedTokens",args:[j.vault,(0,u.su)("1")]}),H=(0,m.dq)((0,u.ok)(Z,[1])),_=(0,u.ok)(F,[1]),O=(0,g.useMemo)(()=>0n==_?0n:(0,u.su)("1")*d.Pq/_,[_]),I=(0,g.useMemo)(()=>{let e=h[j.xTokenSymbol];return!e||0n==e||0n==O||O>=e?"0.00%":(0,u.Jh)((e-O)*d.Pq/e,18,2)},[h[j.xTokenSymbol],O]),W=(0,l.jsxs)("div",{style:{position:"relative",left:L,transform:"translate(-50%,0)"},className:"flex flex-col items-center w-fit rounded-sm",children:[(0,l.jsxs)("div",{className:"text-xs flex flex-col justify-center items-center p-1.5 px-4",children:[(0,l.jsx)("span",{className:"text-neutral-400",children:"Current AAR"}),(0,l.jsx)("span",{className:"font-medium",children:(0,u.Rr)(null==w?void 0:w.aar,null==w?void 0:w.AARDecimals)})]}),(0,l.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M5 7.5L0.669873 -7.57104e-07L9.33013 0L5 7.5Z",fill:"#262626"})})]}),X=(0,l.jsxs)("div",{style:{position:"relative",left:U,transform:"translate(-50%,0)"},className:"flex flex-col items-center w-fit rounded-sm",children:[(0,l.jsx)("svg",{className:"rotate-180",width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M5 7.5L0.669873 -7.57104e-07L9.33013 0L5 7.5Z",fill:B?"#E83B3B":"#54E83B"})}),(0,l.jsxs)("div",{className:"text-xs flex flex-col justify-center items-center p-1.5 px-4",children:[(0,l.jsxs)("span",{className:"font-medium",children:["AAR=",B?(0,u.Rr)(null==w?void 0:w.AARS,null==w?void 0:w.AARDecimals):(0,u.Rr)(null==w?void 0:w.AART,null==w?void 0:w.AARDecimals)]}),(0,l.jsx)("span",{className:"text-neutral-400",children:B?"Trigger discount":"Discount end"})]})]}),ValutArea=e=>{let{discountEnable:s,imageSrc:t,token:a}=e;return(0,l.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-3xl flex p-4 w-full mb-[30px]",children:[(0,l.jsxs)("div",{className:"w-[170px] flex items-center",children:[(0,l.jsx)(f(),{src:t,width:54,height:54,className:"mr-[10px]",alt:""}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"text-xl font-bold",children:[a," Vault"]}),(0,l.jsx)("div",{className:"text-sm flex items-center gap-2",children:(0,l.jsxs)("div",{className:"flex items-center text-neutral-700 gap-1",children:[(0,l.jsx)("div",{className:(0,p.m)("w-3 h-3 rounded-full",s?"bg-violet-500":"bg-green-500")}),y]})})]})]}),(0,l.jsxs)("div",{className:"w-[calc(100%-160px)] p-4 rounded-lg flex flex-col gap-2",children:[W,(0,l.jsx)("div",{className:"h-px bg-[#64748B] after:content-['AAR'] after:inline-block after:text-right after:w-full after:text-xs after:text-[#64748B]"}),X]})]})};return(0,l.jsxs)("div",{className:"mx-auto max-w-screen-lg p-4",children:[(0,l.jsxs)("div",{className:"bg-indigo-50 p-6 lg:p-12 rounded-3xl relative",children:[(0,l.jsx)("h3",{className:"text-indigo-500 font-medium text-xl",children:"Discount Offer"}),(0,l.jsx)("div",{className:"text-indigo-900 mt-4 lg:w-3/4",children:"Due to fluctuations in the prices of underlying assets, when the AAR decreases, the protocol will offer users the opportunity to purchase xToken at a discount with $USB. This means that you can engage in arbitrage."}),(0,l.jsx)(f(),{src:"/discount.png",width:400,height:200,className:"lg:absolute lg:-right-8 lg:top-1/2 lg:-translate-y-1/2 mt-8",alt:""})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-8 mt-8 p-6",children:[(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)(ValutArea,{discountEnable:S,imageSrc:"./ETH.svg",token:j.assetTokenSymbol}),(0,l.jsx)(ValutArea,{discountEnable:S,imageSrc:"./ETHx.svg",token:j.assetTokenSymbol})]}),(0,l.jsxs)("div",{className:"w-full bg-white border border-neutral-200 p-[30px] pt-[60px] rounded-3xl mb-[30px]",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center gap-2 w-full mx-auto",children:[(0,l.jsx)(n.W,{asset:"USB",amount:V,setAmount:C,balance:E,exchange:(0,m.dq)((0,u.su)(V)*(0,u.ok)(h,"USB",d.Pq)/d.Pq)}),(0,l.jsxs)("div",{className:"flex items-center justify-center w-full",children:[(0,l.jsx)("div",{className:"flex-1"}),(0,l.jsx)(v.gPZ,{className:"w-6 h-6 text-neutral-500  border border-neutral-200 rounded-full my-[10px]"}),(0,l.jsx)("div",{className:"flex-1"})]}),(0,l.jsxs)("div",{className:"w-full flex-1 text-right text-neutral-700 text-sm whitespace-nowrap",children:["Disount Rate: ",B?"N/A":I]}),(0,l.jsx)(n.W,{asset:j.xTokenSymbol,amount:H,exchange:(0,m.dq)(D*(0,u.ok)(Z,[1])/d.Pq),readonly:!0,hasInput:!0,options:P,defaultValue:P[0],onChange:e=>{console.log(e.value),M(e.value)}})]}),(0,l.jsx)(a.v,{tx:"Swap",disabled:(0,u.su)(V)>E||!S,onTxSuccess:()=>{C("")},config:{abi:i.Z,address:j.vault,functionName:"usbToLeveragedTokens",args:[(0,u.su)(V)],enabled:S},approves:{[c.O1[(0,o.BV)()]]:(0,u.su)(V)},spender:j.vault})]})]})]})}}},function(e){e.O(0,[27,33,986,866,205,725,619,356,203,975,971,472,744],function(){return e(e.s=33490)}),_N_E=e.O()}]);