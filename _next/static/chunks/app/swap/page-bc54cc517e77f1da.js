(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[998],{79469:function(e,s,t){Promise.resolve().then(t.bind(t,94017))},94017:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return P}});var l=t(9268),a=t(90937),n=t(76394),i=t.n(n),d=t(27374),r=t(86006),o=t(77941),c=t(43534),u=t(82861),m=t(44028);function x(){var e;let{prices:s}=(0,r.useContext)(o.SwapContext);return(0,l.jsxs)("div",{className:"card w-full h-fit flex flex-col",children:[(0,l.jsxs)("h5",{className:"font-bold text-sm text-slate-700",children:["Net Value",(0,l.jsx)(m.zt,{children:(0,l.jsxs)(m.fC,{children:[(0,l.jsx)(m.xz,{asChild:!0,children:(0,l.jsx)("div",{className:"inline-block px-1",children:(0,l.jsx)(d.if7,{className:"ml-1 inline-block w-[14px] h-[14px] stroke-slate-500"})})}),(0,l.jsx)(m.h_,{children:(0,l.jsxs)(m.VY,{className:"max-w-xs text-sm text-white bg-slate-900 rounded-md p-4",children:["The Net value is calculated based on the underlying assets and is backed by these assets. The Market Price on secondary markets might deviate from the Net value due to a variety of factors. Anyone can engage in arbitrage, and such actions will serve to eliminate these discrepancies.",(0,l.jsx)(m.Eh,{})]})})]})})]}),(0,l.jsxs)(a.iA,{className:"mt-4 text-sm",children:[(0,l.jsx)(a.ss,{}),(0,l.jsxs)(a.RM,{children:[(0,l.jsxs)(a.SC,{children:[(0,l.jsxs)(a.pj,{className:"font-medium flex gap-2 px-0",children:[(0,l.jsx)(i(),{src:"/usb.svg",width:20,height:20,alt:"usb"}),"USB"]}),(0,l.jsx)(a.pj,{children:"Universal Stable Basis"}),(0,l.jsx)(a.pj,{className:"text-right",children:"$1"})]}),null===(e=c.C)||void 0===e?void 0:e.map(e=>{var t;return(0,l.jsxs)(a.SC,{children:[(0,l.jsxs)(a.pj,{className:"font-medium flex gap-2 px-0",children:[(0,l.jsx)(i(),{src:"/".concat(e.xTokenSymbol,".svg"),width:20,height:20,alt:e.xTokenSymbol}),e.xTokenSymbol]}),(0,l.jsxs)(a.pj,{children:["Leverage on ",e.assetTokenSymbol]}),(0,l.jsxs)(a.pj,{className:"text-right",children:["$",(0,u.dq)(null==s?void 0:null===(t=s.find(s=>s.symbol===e.xTokenSymbol))||void 0===t?void 0:t.price)]})]},e.assetTokenSymbol)})]})]}),(0,l.jsx)("button",{className:"self-end text-slate-900 underline text-sm",children:"Check the leverage"})]})}var h=t(90995),f=t(12120);let v=e=>c.C.findIndex(s=>s.assetTokenSymbol===e)>-1,b=e=>c.C.findIndex(s=>s.xTokenSymbol===e)>-1,j=(e,s)=>{for(let t=0;t<c.C.length;t++){let l=[c.C[t].assetTokenSymbol,c.C[t].xTokenSymbol];if(l.findIndex(s=>s===e)>-1||l.findIndex(e=>e===s)>-1)return t}};var g=t(19707),p=t(18624),N=t(88426);let y=e=>{let{className:s}=e;return(0,l.jsxs)("svg",{fill:"none",className:s?"text-white":"animate-spin h-5 w-5 2-ml-1 2mr-3",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})};var w=t(51265),S=t(85418),B=t(90863),k=t(89725),C=t(57756),T=t(69624);let U=(e,s)=>{let{config:t}=(0,g.PJ)({address:e,abi:T.em,functionName:"approve",args:[s,100000000n*BigInt(1e18)],enabled:!!s&&!!e&&"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE"!==e}),{write:l,data:a,isLoading:n}=(0,g.GG)(t),{isLoading:i}=(0,g.BX)({hash:null==a?void 0:a.hash});return{approve:l,isApproveLoading:n||i}};var L=t(47864);let E=(e,s,t,l)=>{let{config:a}=(0,g.PJ)({address:e,abi:p.j,functionName:"mintUSB",args:[(0,N.f)(s)],enabled:(0,N.f)(s)>0&&l,value:(0,N.f)(t)}),{write:n,data:i,isLoading:d}=(0,g.GG)(a),{isLoading:r}=(0,g.BX)({hash:null==i?void 0:i.hash});return{mintUSB:n,isMintLoading:d||r}},M=(e,s,t,l)=>{let{config:a}=(0,g.PJ)({address:e,abi:p.j,functionName:"mintXTokens",args:[(0,N.f)(s)],enabled:!!s&&l,value:(0,N.f)(t)}),{write:n,data:i,isLoading:d}=(0,g.GG)(a),{isLoading:r}=(0,g.BX)({hash:null==i?void 0:i.hash});return{mintXToken:n,isMintXLoading:d||r}},R=(e,s,t)=>{let{config:l}=(0,g.PJ)({address:e,abi:p.j,functionName:"redeemByXTokens",args:[(0,N.f)(s)],enabled:(0,N.f)(s)>0&&t}),{write:a,data:n,isLoading:i}=(0,g.GG)(l),{isLoading:d}=(0,g.BX)({hash:null==n?void 0:n.hash});return{redeemByXToken:a,isRedeemByXTokenLoading:i||d}},A=(e,s,t)=>{let{config:l}=(0,g.PJ)({address:e,abi:p.j,functionName:"redeemByUSB",args:[(0,N.f)(s)],enabled:(0,N.f)(s)>0&&t}),{write:a,data:n,isLoading:i}=(0,g.GG)(l),{isLoading:d}=(0,g.BX)({hash:null==n?void 0:n.hash});return{redeemByUSB:a,isRedeemByUSBLoading:i||d}},X=(e,s,t)=>{let{config:l}=(0,g.PJ)({address:e,abi:p.j,functionName:"usbToXTokens",args:[(0,N.f)(s)],enabled:!!s&&t}),{write:a,data:n,isLoading:i}=(0,g.GG)(l),{isLoading:d}=(0,g.BX)({hash:null==n?void 0:n.hash});return{usb2XToken:a,isUsb2XTokenLoading:i||d}},G=(e,s,t,l,a)=>{let{mintUSB:n,isMintLoading:i}=E(e,s,"ETH"===t?s:"0",a!==B.q&&"USB"===l),{mintXToken:d,isMintXLoading:o}=M(e,s,"ETH"===t?s:"0",v(t)&&b(l)),{redeemByXToken:c,isRedeemByXTokenLoading:u}=R(e,s,b(t)&&v(l)),{redeemByUSB:m,isRedeemByUSBLoading:x}=A(e,s,a!==B.q&&"USB"===t&&b(l)),{usb2XToken:h,isUsb2XTokenLoading:f}=X(e,s,"USB"===t&&b(l)),j=(0,r.useMemo)(()=>v(t)?"USB"===l?n:d:"USB"===t?v(l)?m:h:c,[t,l,n,d,m,h,c]);return{swap:j,isSwapLoading:i||o||u||x||f}};function I(e){let{supply:s,upperLimit:t}=e;return(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm text-slate-700",children:"USB Circulating Supply / Upper Limit"}),(0,l.jsx)("div",{className:"mt-2 flex items-center gap-2",children:(0,l.jsxs)(h.fC,{disabled:!0,min:0,max:t,value:[s],className:"relative flex flex-1 items-center select-none touch-none h-5",children:[(0,l.jsx)(h.fQ,{className:"bg-slate-100 relative grow rounded-full h-[3px]",children:(0,l.jsx)(h.e6,{className:"absolute bg-slate-900 rounded-full h-full"})}),(0,l.jsx)(h.bU,{className:"relative block w-3 h-3 bg-slate-900 rounded-full border-2 border-slate-900 focus:outline-none",children:(0,l.jsx)("div",{className:"text-xs text-slate-500 absolute whitespace-nowrap top-3 -translate-x-1/2",children:"".concat(s.toLocaleString()," / ").concat(t.toLocaleString())})})]})}),(0,l.jsx)("div",{className:"mt-6 text-xs text-slate-500 text-center",children:"The upper limit will grow with the demand for leverage."})]})}function J(e){let{rebalanceBonusLoss:s,reward:t,isBonus:a}=e;return(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("div",{className:"text-slate-700",children:"Rebalance bonus/loss"}),(0,l.jsx)("div",{className:"".concat(a?"text-green-400":"text-red-400"),children:s})]}),(0,l.jsxs)("div",{className:"flex justify-between mt-3",children:[(0,l.jsx)("div",{className:"text-slate-700",children:"Reward"}),(0,l.jsxs)("div",{className:"text-slate-900",children:["$",t," Wand"]})]})]})}function q(){var e,s,t,a,n,i,d,m,x,h;let{balances:T}=(0,r.useContext)(C.FetcherContext),{prices:E,r2s:M,allowances4pool:R,totalUpperLimit:A}=(0,r.useContext)(o.SwapContext),[X,q]=(0,r.useState)(""),[P,F]=(0,r.useState)("ETH"),[V,_]=(0,r.useState)("USB"),z=L.e.find(e=>e.symbol===P),O=null==T?void 0:null===(e=T.find(e=>e.symbol===P))||void 0===e?void 0:e.balance,D=null==T?void 0:null===(s=T.find(e=>e.symbol===V))||void 0===s?void 0:s.balance,H=null==R?void 0:null===(t=R.find(e=>e.symbol===P))||void 0===t?void 0:t.allowance,Y=H<(0,N.f)(X),Z=(0,r.useMemo)(()=>c.C.reduce((e,s)=>e.concat([s.assetTokenSymbol,s.xTokenSymbol]),["USB"]),[]),$=(0,r.useMemo)(()=>"USB"===P?Z.filter(e=>e!==P):v(P)?["USB",P+"x"]:b(P)?[P.replace("x","")]:Z,[Z,P]);(0,r.useEffect)(()=>_($[0]),[P,$]);let Q=(0,r.useMemo)(()=>j(P,V),[P,V]),W=(0,r.useMemo)(()=>{var e,s;return null===(s=c.C)||void 0===s?void 0:null===(e=s[null!=Q?Q:0])||void 0===e?void 0:e.poolAddress},[Q]),K=(0,r.useMemo)(()=>{var e,s;return null===(s=c.C)||void 0===s?void 0:null===(e=s[null!=Q?Q:0])||void 0===e?void 0:e.assetTokenSymbol},[Q]),ee=null!==(d=null==M?void 0:null===(a=M.find(e=>e.symbol===K))||void 0===a?void 0:a.r2)&&void 0!==d?d:0n,{swap:es,isSwapLoading:et}=G(W,X,P,V,ee),{approve:el,isApproveLoading:ea}=U(null==z?void 0:z.address[(0,S.B)()],W),{data:en}=(0,g.do)({address:W,abi:p.j,functionName:"calculateMintUSBOut",args:[(0,N.f)(X)],chainId:(0,S.B)(),enabled:(0,N.f)(X)>0&&"USB"===V});console.log(en);let{data:ei}=(0,g.do)({address:W,abi:p.j,functionName:"calculateMintXTokensOut",args:[(0,N.f)(X)],chainId:(0,S.B)(),enabled:(0,N.f)(X)>0&&b(V)&&"USB"!==P}),{data:ed}=(0,g.do)({address:W,abi:p.j,functionName:"calculateUSBToXTokensOut",args:[(0,N.f)(X)],chainId:(0,S.B)(),enabled:(0,N.f)(X)>0&&"USB"===P&&b(V)}),er=null!==(m="USB"===V?en:"USB"===P?ed:ei)&&void 0!==m?m:0n,eo=(0,N.f)(X),ec=null!==(x=null==E?void 0:null===(n=E.find(e=>e.symbol===P))||void 0===n?void 0:n.price)&&void 0!==x?x:0n,eu=null!==(h=null==E?void 0:null===(i=E.find(e=>e.symbol===V))||void 0===i?void 0:i.price)&&void 0!==h?h:0n,em=ec*eo>0?(eu*er/(ec*eo)-1n)*100n:0n,ex="USB"===V&&ee===B.q;return(0,l.jsx)("div",{className:"card w-full",children:(0,l.jsxs)(f.fC,{defaultValue:"swap",children:[(0,l.jsx)(f.aV,{className:"bg-slate-100 p-1 w-fit rounded-md",children:[{label:"Atomic Swap",value:"swap"},{label:"Redeem",value:"redeem"}].map(e=>{let{label:s,value:t}=e;return(0,l.jsx)(f.xz,{className:'rounded-[3px] text-sm py-1.5 px-3 text-slate-500 font-medium data-[state="active"]:bg-white data-[state="active"]:text-slate-900',value:t,children:s},t)})}),(0,l.jsx)(f.VY,{value:"swap",className:"flex flex-col gap-6 mt-6",children:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(w.i,{label:"Input",amount:X,setAmount:q,options:Z,symbol:P,setSymbol:F,slot:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"text-sm text-slate-500 mt-1 pl-3",children:["Balance: ",(0,u.dq)(O)]}),(0,l.jsx)("button",{className:"btn-secondary absolute right-24 top-1/2 -translate-y-1/2 w-fit",children:"Max"})]})}),(0,l.jsx)("div",{className:"w-12 h-12 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-3/4 z-10 bg-white border border-slate-200 rounded-full flex items-center justify-center",children:(0,l.jsx)(k.YRR,{className:"stroke-slate-900 w-6 h-6"})}),(0,l.jsx)(w.i,{className:"mt-3",label:"Receive",amount:(0,u.ZM)(er),setAmount:q,options:$,symbol:V,setSymbol:_,slot:(0,l.jsxs)("div",{className:"text-sm text-slate-500 mt-1 pl-3",children:["Balance: ",(0,u.dq)(D)]})})]}),(0,l.jsx)("div",{className:"text-xs text-red-500 -mt-5 h-[20px]",children:ex&&(0,l.jsx)(l.Fragment,{children:"USB minting has reached limit in this pool, please use other assets for minting."})}),(0,l.jsx)(I,{supply:1232232.98,upperLimit:Number((0,u.ZM)(A))}),(0,l.jsx)(J,{rebalanceBonusLoss:ex?"Mint Pause":(0,u.dq)(em)+"%",isBonus:em>0,reward:32}),Y?(0,l.jsxs)("button",{className:"btn-primary flex items-center justify-center gap-4",onClick:el,disabled:!el||ea,children:[ea&&(0,l.jsx)(y,{}),"Approve"]}):(0,l.jsxs)("button",{className:"btn-primary flex items-center justify-center gap-4",onClick:es,disabled:!es||et,children:[et&&(0,l.jsx)(y,{}),"Buy"]})]})}),(0,l.jsxs)(f.VY,{value:"redeem",className:"flex flex-col gap-3",children:[(0,l.jsx)("div",{className:"text-sm text-slate-500",children:"Tip：Redemption requires both x and $USB"}),(0,l.jsxs)("div",{children:[(0,l.jsx)(w.i,{options:[],label:"Input",slot:(0,l.jsxs)("div",{className:"flex items-center mt-1 ",children:[(0,l.jsx)("div",{className:"text-sm text-slate-500 pl-3",children:"Balance: 0.001"}),(0,l.jsx)("div",{className:"text-sm text-slate-500 pl-3",children:"Requires pairing with 2,323.22 USB"}),(0,l.jsx)("button",{className:"inline-block text-indigo-500 text-sm underline ml-auto",children:"Not enough? Buy Now."})]})}),(0,l.jsx)(w.i,{className:"mt-3",options:[],label:"Receive",slot:(0,l.jsx)("div",{className:"text-sm text-slate-500 mt-1 pl-3",children:"Balance: 0.001"})})]}),(0,l.jsx)("div",{className:"text-right text-sm text-slate-500",children:"Redemption fee: 0.5%"}),(0,l.jsx)("button",{className:"btn-primary",children:"Redeem"})]})]})})}function P(){return(0,l.jsxs)("div",{className:"flex flex-col md:flex-row w-full gap-3",children:[(0,l.jsx)(q,{}),(0,l.jsx)(x,{})]})}},51265:function(e,s,t){"use strict";t.d(s,{i:function(){return o}});var l=t(9268),a=t(32726),n=t(63831),i=t(27374),d=t(76394),r=t.n(d);function o(e){let{className:s,options:t=[],label:d,slot:o,symbol:c,setSymbol:u,amount:m,setAmount:x}=e;return(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("div",{className:(0,n.Z)("relative",s),children:[(0,l.jsx)("div",{className:"absolute top-2 left-3 font-medium text-sm text-slate-700",children:d}),(0,l.jsx)("input",{type:"number",className:"w-full h-16 pt-6 pl-3 font-bold text-2xl border text-slate-700 border-slate-200 rounded-md focus:ring-2 focus:outline-blue-500",placeholder:"0.00",value:m,onChange:e=>x(e.target.value)}),(0,l.jsxs)(a.fC,{disabled:(null==t?void 0:t.length)<2,defaultValue:c,value:c,onValueChange:e=>u(e),children:[(0,l.jsxs)(a.xz,{className:"flex h-4 items-center absolute right-3 bottom-3",children:[(0,l.jsx)(a.B4,{className:"bg-white mr-1",placeholder:""}),(null==t?void 0:t.length)>=2?(0,l.jsx)(a.JO,{children:(0,l.jsx)(i.kWQ,{})}):null]}),(0,l.jsx)(a.h_,{children:(0,l.jsx)(a.VY,{className:"bg-white shadow-lg border p-1 rounded-md",children:(0,l.jsx)(a.l_,{children:null==t?void 0:t.map(e=>(0,l.jsx)(a.ck,{className:"flex px-4 py-2 text-sm rounded- gap-2 hover:bg-slate-100 cursor-pointer",value:e,children:(0,l.jsx)(a.eT,{children:(0,l.jsxs)("div",{className:"flex items-center leading-4 font-medium",children:[(0,l.jsx)(r(),{width:16,height:16,src:"/".concat(e,".svg"),alt:"",style:{display:"inline-block",marginRight:4}}),e]})})},e))})})})]})]}),o]})}},90863:function(e,s,t){"use strict";t.d(s,{q:function(){return l}});let l=10n**10n},47864:function(e,s,t){"use strict";t.d(s,{e:function(){return d}});var l=t(43534),a=t(80237),n=t(61997);let i={[a.ws.id]:"0x3BC8EDA06555c061Ab5363Fc2b642C977BDcD6a6",[n.RJ.id]:""},d=[...l.C.map(e=>({symbol:e.assetTokenSymbol,address:{[a.ws.id]:e.assetTokenAddress,[n.RJ.id]:e.assetTokenAddress}})).filter(e=>"ETH"!==e.symbol),...l.C.map(e=>({symbol:e.xTokenSymbol,address:{[a.ws.id]:e.xTokenAddress,[n.RJ.id]:e.xTokenAddress}})),{symbol:"USB",address:{[a.ws.id]:i[a.ws.id],[n.RJ.id]:i[n.RJ.id]}}]},57756:function(e,s,t){"use strict";t.r(s),t.d(s,{FetcherContext:function(){return o},FetcherProvider:function(){return c}});var l=t(9268),a=t(86006),n=t(19707),i=t(69624),d=t(85418),r=t(47864);let o=(0,a.createContext)({balances:[]}),c=e=>{let{children:s}=e,{address:t}=(0,n.mA)(),{data:c}=(0,n.KQ)({address:t,watch:!0,chainId:(0,d.B)()});console.log("fuck",c);let{data:u}=(0,n.Dm)({contracts:[...r.e.map(e=>({address:e.address[(0,d.B)()],abi:i.em,functionName:"balanceOf",args:[t],chainId:(0,d.B)()}))],watch:!0,enabled:!!t,allowFailure:!0});console.log(u),console.log(r.e);let m=r.e.length,x=(0,a.useMemo)(()=>null==u?void 0:u.filter((e,s)=>s<m).map((e,s)=>{var t;return{symbol:null===(t=r.e[s])||void 0===t?void 0:t.symbol,balance:null==e?void 0:e.result}}),[u]);return(0,l.jsx)(o.Provider,{value:{balances:x?[...x,{symbol:"ETH",balance:null==c?void 0:c.value}]:[]},children:s})}},82861:function(e,s,t){"use strict";t.d(s,{Rp:function(){return n},ZM:function(){return d},dq:function(){return i}});var l=t(77340),a=t(11639);let n=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,t=arguments.length>2?arguments[2]:void 0;if(!e)return"0.000";let a=10**s;return(Math.floor(Number((0,l.b)(e,t))*a)/a).toLocaleString("en-US",{maximumFractionDigits:s})},i=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!e)return"0.000";let t=10**s;return(Math.floor(Number((0,a.d)(e))*t)/t).toLocaleString("en-US",{maximumFractionDigits:s})},d=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(!e)return"0.000";let t=10**s;return String(Math.floor(Number((0,a.d)(e))*t)/t)}}},function(e){e.O(0,[287,524,405,707,938,761,641,597,941,253,961,744],function(){return e(e.s=79469)}),_N_E=e.O()}]);